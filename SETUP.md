# セットアップ＆テストプレイ手順

## 必要な準備

### 1. Supabaseプロジェクトの作成

1. [Supabase](https://supabase.com/)にアクセス
2. 新しいプロジェクトを作成
3. プロジェクト名を入力（例: world-travel-game）
4. データベースパスワードを設定
5. リージョンを選択（日本なら Tokyo がおすすめ）

### 2. 環境変数の設定

1. Supabaseダッシュボードで「Settings」→「API」を開く
2. 以下の値をコピー：
   - Project URL
   - anon public key

3. プロジェクトルートに`.env.local`ファイルを作成：

```env
NEXT_PUBLIC_SUPABASE_URL=あなたのProject URL
NEXT_PUBLIC_SUPABASE_PUBLISHABLE_KEY=あなたのanon public key
```

### 3. データベースのセットアップ

#### 方法1: Supabase SQL Editor を使用（推奨）

1. Supabaseダッシュボードで「SQL Editor」を開く
2. 「New query」をクリック
3. `supabase/migrations/20251213000001_initial_schema.sql`の内容をコピペ
4. 「Run」をクリック
5. 同様に`supabase/migrations/20251213000002_sample_data.sql`を実行

#### 方法2: Supabase CLI を使用

```bash
# Supabase CLIをインストール（初回のみ）
npm install -g supabase

# プロジェクトとリンク
supabase link --project-ref your-project-ref

# マイグレーションを実行
supabase db push
```

### 4. 依存関係のインストール

```bash
cd khf21
npm install
```

### 5. 開発サーバーの起動

```bash
npm run dev
```

ブラウザで http://localhost:3000 を開く

## テストプレイの流れ

### 1. ユーザー登録（オプション）

- トップページの「Sign up」からアカウントを作成
- または、ログインせずにゲスト状態でもプレイ可能

### 2. ゲーム開始

1. 「🎮 ゲームを始める」ボタンをクリック
2. 旅の期間を選択（テストは「1週間」がおすすめ）
3. 出発空港を選択（検索機能も使えます）
   - 東京: 成田国際空港 (NRT) または 東京国際空港 (HND)
   - ニューヨーク: JFK
   - パリ: CDG
   - など20空港から選択可能

### 3. ゲームプレイ

1. **マップ画面**
   - 現在地が表示されます
   - 「次の目的地へ」ボタンをクリック

2. **ルーレット画面**
   - 「ルーレットを回す」ボタンをクリック
   - 1-6のマス数が決定

3. **イベント画面**（ランダムで発生）
   - 📍 **名所訪問**: エッフェル塔、自由の女神像など
   - ⭐ **スター遭遇**: フレディ・マーキュリー、レオナルド・ディカプリオなど
   - 🎵 **アート鑑賞**: シルク・ドゥ・ソレイユ、オペラなど
   - 🍽️ **グルメ体験**: 寿司、ピッツァ、北京ダックなど
   - ⚠️ **トラブル発生→解消**: スリ、遅延などのトラブルとその解決
   - 🎁 **喜び提供**: 困っている人を助ける選択肢

4. **ポイント獲得**
   - 感動体験（Impressed）ポイント
   - 喜び提供（Giver）ポイント
   - ヘッダーに常時表示

5. **ゲーム終了**
   - 設定した期間が経過すると終了
   - 合計ポイントが表示されます

## 確認ポイント

### ✅ 動作確認項目

- [ ] ゲーム開始画面で空港が20件表示される
- [ ] 空港検索機能が動作する
- [ ] 期間選択（1週間〜1年）ができる
- [ ] ルーレットが回転する
- [ ] イベントがランダムで発生する
- [ ] 各イベントの画像/説明が表示される
- [ ] ポイントが正しく加算される
- [ ] 経過日数が表示される
- [ ] ゲーム終了画面が表示される

### 📱 モバイル対応確認

- [ ] スマホブラウザでアクセス
- [ ] タッチ操作がスムーズ
- [ ] 画面サイズに適応している
- [ ] ボタンが押しやすい

## サンプルデータ一覧

### 空港（20箇所）
- 東京（成田・羽田）
- ニューヨーク、ロサンゼルス、サンフランシスコ
- ロンドン、パリ、ローマ、バルセロナ、フランクフルト、アムステルダム
- ドバイ、シンガポール、ソウル、香港、バンコク
- シドニー、サンパウロ、トロント、メキシコシティ

### 名所（10箇所）
- エッフェル塔、自由の女神像、万里の長城
- タージ・マハル、マチュ・ピチュ、コロッセオ
- シドニー・オペラハウス、サグラダ・ファミリア
- グランドキャニオン、富士山

### スター（10名）
- フレディ・マーキュリー、マイケル・ジャクソン
- レオナルド・ディカプリオ、トム・ハンクス
- ピカソ、バンクシー
- クリスティアーノ・ロナウド、セリーナ・ウィリアムズ
- ビヨンセ、エド・シーラン

### アート（10件）
- シルク・ドゥ・ソレイユ、ラ・ボエーム
- 白鳥の湖、ビートルズ：ラブ
- フラメンコショー、ジャズナイト、歌舞伎
- ブロードウェイミュージカル、ルーヴル美術館、大道芸

### グルメ（10品）
- 寿司、クロワッサン、ナポリピッツァ
- 北京ダック、タコス、フィッシュアンドチップス
- パエリア、フォー、BBQリブ、パッタイ

### トラブル（8種類）
- スリ、飛行機遅延、荷物紛失
- 食中毒、ホテルオーバーブッキング
- 詐欺、自然災害、交通ストライキ

## トラブルシューティング

### データが表示されない場合

1. ブラウザのコンソールを開いて、エラーを確認
2. `.env.local`の設定を再確認
3. Supabaseでマイグレーションが正しく実行されたか確認
4. ブラウザのキャッシュをクリア

### 空港リストが空の場合

1. Supabase SQL Editorで確認:
```sql
SELECT COUNT(*) FROM airports;
```
2. 20件表示されればOK
3. 0件の場合は、サンプルデータのマイグレーションを再実行

### イベントが発生しない場合

- イベント発生はランダムなので、数回ルーレットを回す
- 確率:
  - 名所: 70%
  - スター: 30%
  - アート: 40%
  - グルメ: 60%
  - トラブル: 20%
  - 喜び提供: 50%

## 次のステップ

テストプレイ後、以下を検討：

1. **データの追加**
   - より多くの空港、名所、スター等
   - 既存アプリからのデータ移行

2. **メディアの追加**
   - 実際の世界地図画像
   - BGM/効果音
   - 名所やグルメの写真

3. **機能の拡張**
   - セーブ/ロード機能
   - 旅の履歴表示
   - マルチプレイヤー対応

---

楽しい世界旅行を！🌍✈️
