# イベント統計表

## イベントカテゴリー別件数と発生率

### 移動中のイベント（マスを進む際）

| イベントタイプ | 発生率 | カテゴリー | 説明 |
|--------------|--------|----------|------|
| 著名人との出会い（星） | 25% | 感動体験 | 機内で有名人と出会うイベント |
| トラブル | 10% | マイナス | 盗難、フライト遅延、エンジン故障などのトラブル |
| 喜び提供 (Giver) | 20% | 他者貢献 | 困っている人を助けるイベント |
| 元気づけ/感謝 | 15% | 感動体験 | 励まし合ったり感謝されるイベント |
| **イベントなし** | 30% | - | 何も起きずに移動 |

**合計発生率: 70%** （30%の確率でイベントなし）

### 到着時のイベント（目的地到達後）

| イベントタイプ | 発生率 | カテゴリー | 説明 |
|--------------|--------|----------|------|
| スター遭遇 | 30% | 感動体験 | 目的地で有名人と遭遇 |
| **イベントなし** | 70% | - | 通常の到着 |

### 到着選択画面での体験（プレイヤーが選択）

| 体験タイプ | 選択確率 | カテゴリー | 説明 |
|----------|---------|----------|------|
| 名所訪問 (Attraction) | 任意 | 感動体験 | 世界遺産、ランドマークなどを訪問 |
| アート鑑賞 (Art) | 任意 | 感動体験 | コンサート、ミュージカル、ストリートアートなど |
| グルメ体験 (Gourmet) | 任意 | 感動体験 | 現地の美味しい料理を楽しむ |

**注:** 到着選択画面では、プレイヤーが3つの選択肢から1つを選びます。発生率ではなく、プレイヤーの選択に依存します。

---

## イベントによるポイント獲得

### 感動ポイント (Impressed Points)
- 名所訪問: 10-100pt（データベースに定義）
- 星イベント: データベース定義による
- アート鑑賞: 10-100pt（データベースに定義）
- グルメ体験: 10-100pt（データベースに定義）
- 元気づけ/感謝: データベース定義による
- トラブル: マイナスポイント（解決後プラス）

### 喜びポイント (Giver Points)
- 喜び提供イベント: 25pt
- 元気づけ/感謝イベント: データベース定義による

---

## イベント発生の仕組み

### 1. 移動中（マスを進む際）
- `generateTravelEvents()` 関数が呼ばれる
- ランダムロールで1つのイベントが選ばれる（または何も起きない）
- 発生したイベントは移動後に表示される

### 2. 到着時
- `generateArrivalEvents()` 関数が呼ばれる
- 30%の確率でスター遭遇イベント
- その後、到着選択画面で名所・アート・グルメから1つを選択

---

## フリーマン向けのポイント倍率

フリーマン（AIプレイヤー）は、人間プレイヤーとのバランスを取るため、獲得ポイントが **2.0倍** になります。

- フリーマンの到着ポイント: 2.0倍
- フリーマンの体験ポイント: 2.0倍
- フリーマンの追い抜きボーナス: 2.0倍
- フリーマンのイベントポイント: 2.0倍

---

## 将来の拡張: マスごとのイベント表示

### 実装案
各マスにイベントが発生した場合、そのマスの色を変更して表示することが可能です。

**色分けの提案:**
- 🟢 **緑色**: 感動体験（星、元気づけ/感謝）
- 🟡 **黄色**: 喜び提供（Giver）
- 🔴 **赤色**: トラブル
- ⚪ **白色**: イベントなし（通常）

**実装方法:**
1. 各マスに `event_type` 情報を追加
2. WorldMapコンポーネントで経路マーカーの色を動的に変更
3. イベント発生時にマスの情報を更新

**コード例:**
```typescript
// マスにイベント情報を追加
interface RouteSpace {
  lat: number;
  lng: number;
  spaceNumber: number;
  eventType?: 'star' | 'trouble' | 'giver' | 'encouragement_gratitude' | null;
}

// 色マッピング
const EVENT_COLORS = {
  star: '#10b981',                    // 緑（感動）
  encouragement_gratitude: '#10b981', // 緑（感動）
  giver: '#eab308',                   // 黄色（喜び）
  trouble: '#ef4444',                 // 赤（トラブル）
  null: '#9ca3af',                    // グレー（イベントなし）
};

// マーカーの色を設定
<CircleMarker
  fillColor={EVENT_COLORS[space.eventType || null]}
  ...
/>
```

---

## 統計データの活用

### ゲーム終了時に表示する統計例
- 発生したイベント総数
- カテゴリー別イベント件数
- 獲得ポイントの内訳（到着・感動・喜び）
- 最も多く訪れた大陸
- トラブル遭遇回数と解決率

これらの統計は、プレイヤーの旅の振り返りに活用できます。
